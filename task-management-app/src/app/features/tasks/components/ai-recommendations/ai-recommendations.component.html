<div class="ai-recommendations" *ngIf="suggestions" role="region" aria-label="AIによるタスク分析と推奨事項">
  <!-- タスク情報の表示 -->
  <div class="task-info" *ngIf="task" role="article" aria-label="タスクの詳細情報">
    <div class="task-header">
      <mat-icon [class]="getTaskCategory()" aria-hidden="true">{{ getCategoryIcon(getTaskCategory()) }}</mat-icon>
      <h2 class="task-title" tabindex="0">{{ getTaskTitle() }}</h2>
    </div>
    <div class="task-details">
      <div class="priority" tabindex="0" role="status" [attr.aria-label]="'優先度: ' + getTaskPriority()">
        <mat-icon aria-hidden="true">{{ getPriorityIcon(getTaskPriority()) }}</mat-icon>
        <span>{{ getTaskPriority() }}</span>
      </div>
      <div class="due-date" tabindex="0" role="status" [attr.aria-label]="'期限: ' + formatDate(getTaskDueDate())">
        <mat-icon aria-hidden="true">event</mat-icon>
        <span>{{ formatDate(getTaskDueDate()) }}</span>
      </div>
    </div>
  </div>

  <!-- タブナビゲーション -->
  <mat-tab-group class="recommendations-tabs" (selectedTabChange)="onTabChange($event)" role="tablist">
    <mat-tab label="優先度調整" role="tab" aria-label="優先度調整の推奨事項">
      <mat-expansion-panel *ngFor="let suggestion of suggestions?.priorityAdjustments; let i = index" 
                          role="region" 
                          [attr.aria-label]="'推奨事項 ' + (i + 1)">
        <mat-expansion-panel-header>
          <mat-panel-title>
            <mat-icon aria-hidden="true">priority_high</mat-icon>
            <span>{{ suggestion }}</span>
          </mat-panel-title>
        </mat-expansion-panel-header>
      </mat-expansion-panel>
    </mat-tab>

    <mat-tab label="リソース配分" role="tab" aria-label="リソース配分の推奨事項">
      <mat-expansion-panel *ngFor="let suggestion of suggestions?.resourceAllocation; let i = index"
                          role="region"
                          [attr.aria-label]="'推奨事項 ' + (i + 1)">
        <mat-expansion-panel-header>
          <mat-panel-title>
            <mat-icon aria-hidden="true">group_work</mat-icon>
            <span>{{ suggestion }}</span>
          </mat-panel-title>
        </mat-expansion-panel-header>
      </mat-expansion-panel>
    </mat-tab>

    <mat-tab label="タイムライン" role="tab" aria-label="タイムライン最適化の推奨事項">
      <mat-expansion-panel *ngFor="let suggestion of suggestions?.timelineOptimization; let i = index"
                          role="region"
                          [attr.aria-label]="'推奨事項 ' + (i + 1)">
        <mat-expansion-panel-header>
          <mat-panel-title>
            <mat-icon aria-hidden="true">schedule</mat-icon>
            <span>{{ suggestion }}</span>
          </mat-panel-title>
        </mat-expansion-panel-header>
      </mat-expansion-panel>
    </mat-tab>

    <mat-tab label="タスク管理" role="tab" aria-label="タスク管理の推奨事項">
      <mat-expansion-panel *ngFor="let suggestion of suggestions?.taskManagement; let i = index"
                          role="region"
                          [attr.aria-label]="'推奨事項 ' + (i + 1)">
        <mat-expansion-panel-header>
          <mat-panel-title>
            <mat-icon aria-hidden="true">checklist</mat-icon>
            <span>{{ suggestion }}</span>
          </mat-panel-title>
        </mat-expansion-panel-header>
      </mat-expansion-panel>
    </mat-tab>

    <mat-tab label="共同作業" role="tab" aria-label="共同作業の推奨事項">
      <mat-expansion-panel *ngFor="let suggestion of suggestions?.collaboration; let i = index"
                          role="region"
                          [attr.aria-label]="'推奨事項 ' + (i + 1)">
        <mat-expansion-panel-header>
          <mat-panel-title>
            <mat-icon aria-hidden="true">people</mat-icon>
            <span>{{ suggestion }}</span>
          </mat-panel-title>
        </mat-expansion-panel-header>
      </mat-expansion-panel>
    </mat-tab>
  </mat-tab-group>

  <!-- アクションプラン -->
  <div class="action-plan" *ngIf="suggestions?.actionPlan?.length" role="region" aria-label="アクションプラン">
    <h3 tabindex="0">アクションプラン</h3>
    <mat-list role="list">
      <mat-list-item *ngFor="let action of suggestions?.actionPlan; let i = index" 
                     role="listitem"
                     [attr.aria-label]="'アクション ' + (i + 1) + ': ' + action">
        <mat-icon matListItemIcon aria-hidden="true">arrow_right</mat-icon>
        <span matListItemTitle>{{ action }}</span>
      </mat-list-item>
    </mat-list>
  </div>
</div> 