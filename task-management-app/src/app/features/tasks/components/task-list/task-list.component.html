<div class="task-list-container">
  <div class="task-list-header">
    <h1>タスク一覧</h1>
    <button class="new-task-button" (click)="navigateToNewTask()">新規タスク</button>
  </div>

  <div class="filters">
    <div class="search-box">
      <input type="text" [(ngModel)]="searchQuery" (ngModelChange)="applyFilters()" 
             placeholder="タスクを検索..." class="search-input">
    </div>

    <div class="filter-group">
      <select [(ngModel)]="statusFilter" (ngModelChange)="applyFilters()" class="filter-select">
        <option value="">すべてのステータス</option>
        <option value="未着手">未着手</option>
        <option value="進行中">進行中</option>
        <option value="完了">完了</option>
      </select>

      <select [(ngModel)]="priorityFilter" (ngModelChange)="applyFilters()" class="filter-select">
        <option value="">すべての優先度</option>
        <option value="低">低</option>
        <option value="中">中</option>
        <option value="高">高</option>
      </select>

      <select [(ngModel)]="categoryFilter" (ngModelChange)="applyFilters()" class="filter-select">
        <option value="">すべてのカテゴリ</option>
        <option *ngFor="let category of getUniqueCategories()" [value]="category">
          {{ category }}
        </option>
      </select>
    </div>
  </div>

  <div class="task-table" *ngIf="!loading">
    <table>
      <thead>
        <tr>
          <th (click)="onSort('title')" [class.active]="sortField === 'title'">
            タイトル {{ getSortIcon('title') }}
          </th>
          <th (click)="onSort('status')" [class.active]="sortField === 'status'">
            ステータス {{ getSortIcon('status') }}
          </th>
          <th (click)="onSort('priority')" [class.active]="sortField === 'priority'">
            優先度 {{ getSortIcon('priority') }}
          </th>
          <th (click)="onSort('dueDate')" [class.active]="sortField === 'dueDate'">
            期限 {{ getSortIcon('dueDate') }}
          </th>
          <th>操作</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let task of filteredTasks" (click)="navigateToTask(task.id)" class="task-row">
          <td>{{ task.title }}</td>
          <td>
            <span class="status-badge" [ngClass]="task.status">{{ task.status }}</span>
          </td>
          <td>
            <span class="priority-badge" [ngClass]="task.priority">{{ task.priority }}</span>
          </td>
          <td>{{ task.dueDate | date:'yyyy/MM/dd' }}</td>
          <td>
            <button class="view-button" (click)="navigateToTask(task.id); $event.stopPropagation()">
              詳細
            </button>
          </td>
        </tr>
      </tbody>
    </table>

    <div *ngIf="filteredTasks.length === 0" class="no-tasks">
      タスクが見つかりません
    </div>
  </div>

  <div *ngIf="loading" class="loading">
    読み込み中...
  </div>
</div> 